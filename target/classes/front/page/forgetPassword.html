<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!--edge浏览器H5兼容设置-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="../favicon.ico">
    <title>它它宠物商城</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--导入核心文件-->
    <script src="../bootstrap3/js/holder.js"></script>
    <link href="../bootstrap3/css/bootstrap.css" rel="stylesheet" type="text/css">
    <script src="../bootstrap3/jquery-1.9.1.min.js"></script>
    <script src="../bootstrap3/js/bootstrap.js"></script>
    <!-- 字体图标 -->
    <link rel="stylesheet" href="../bootstrap3/font-awesome-4.7.0/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="../css/top.css" />
    <link rel="stylesheet" type="text/css" href="../css/index.css" />
    <link rel="stylesheet" type="text/css" href="../css/layout.css" />
    <link rel="stylesheet" type="text/css" href="../css/login.css" />
    <link rel="stylesheet" type="text/css" href="../css/footer.css" />
    <script src="../bootstrap3/js/jquery.cookie.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/autoLogin.js" type="text/javascript"></script>
</head>
<body>
<!--头部-->
<header class="header">
    <span class="pull-right"><small>欢迎访问</small><b>它它宠物商城</b></span>
</header>
<!--主体-->
            <div class="container mycontent text-left">
                <!--透明层 -->
                <div class="loginDiv">
                    <h1>找回密码</h1>
                    <form>
                        <div class="form-group">
                            <label for="username">账户名</label>
                            <div class="input-group">
                                <input type="text" id="username" name="username" minlength="6" maxlength="20" placeholder="6-20位字母、数字或下划线" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="phone">注册手机号</label>
                            <div class="input-group">
                                <input type="tel" id="phone" name="phone" pattern="[0-9]{11}" placeholder="请输入11位手机号" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="verify">验证码</label>
                            <div class="input-group">
                                <input type="text" id="verify" name="verify" required>
                                <button type="button" id="send-verify">发送验证码</button>
                            </div>
                        </div>

                        <div class="button-group">
                            <button type="button" id="find-password-btn">找回密码</button>
                            <button type="button" onclick="window.location.href='login.html'">返回登录</button>
                        </div>
                    </form>
                </div>
            </div>
<div class="footer-top">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-6">
                <div class="footer-widget">
                    <h3 class="widget-title">关于我们</h3>
                    <p>我们提供正品保障的宠物用品，让你的宠物生活更愉快。欢迎加入我们的爱宠家庭。</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-widget">
                    <h3 class="widget-title">品类丰富</h3>
                    <ul class="footer-link">
                        <li><a href="listSale2.html?categoryId=16">猫粮</a></li>
                        <li><a href="listSale2.html?categoryId=17">狗粮</a></li>
                        <li><a href="listSale2.html?categoryId=18">宠物玩具</a></li>
                        <li><a href="listSale2.html?categoryId=19">宠物用品</a></li>
                        <li><a href="listSale2.html?categoryId=20">宠物服饰</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-widget">
                    <h3 class="widget-title">优质服务</h3>
                    <ul class="footer-link">
                        <li><a href="shopPlan.html">购物指南</a></li>
                        <li><a href="paymentQE.html">支付问题</a></li>
                        <li><a href="saleBack.html">售后服务</a></li>
                        <li><a href="returnSale.html">退换货政策</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-widget">
                    <h3 class="widget-title">联系我们</h3>
                    <ul class="footer-contact">
                        <li><i class="fas fa-map-marker-alt"></i> </li>
                        <li><i class="fas fa-phone"></i> </li>
                        <li><i class="fas fa-envelope"></i> </li>
                        <li><i class="fas fa-clock"></i> 09:00-18:30 (周一到周日)</li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- 返回顶部按钮 -->
        <div class="row">
            <div class="col-md-12 text-center">
                <a href="#" class="back-to-top">返回顶部<i class="fas fa-chevron-up"></i></a>
            </div>
        </div>
    </div>
</div>
<div class="footer-bottom">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <p>© 2023 爱宠20年. All Rights Reserved.</p>
            </div>
            <div class="col-md-6">
                <div class="footer-payment">
                    <img src="img/payment.jpg" alt="Payment Method" width="80" height="auto">
                </div>
            </div>
        </div>
    </div>
</div>
</footer>
            <script type="text/javascript">
                $(document).ready(function() {
                    var countdown = null; //定时器变量
                    var interval = 60; //定时器间隔时间，单位：秒

                    //发送验证码按钮点击事件
                    $("#send-verify").click(function() {
                        var phone = $("#phone").val();
                        var username = $("#username").val();
                        if (!phone) {
                            alert("请输入手机号");
                            return;
                        }
                        if (!/^1[3-9]\d{9}$/.test(phone)) {
                            alert("请输入正确的中国境内手机号");
                            return;
                        }
                        if (!username) {
                            alert("请输入用户名");
                            return;
                        }
                        if (!/^\w{6,20}$/.test(username)) {
                            alert("用户名为6到20位，只能包含字母、数字或下划线");
                            return;
                        }

                        //禁用发送验证码按钮
                        $(this).prop("disabled", true);

                        //发送验证码
                        $.get("/user/send", {phone: phone, username: username}, function(result) {
                            if (result.state === 200) {
                                alert('短信发送成功！');
                                countDown();
                            } else {
                                alert("短信发送失败：" + result.message);
                                $("#send-verify").prop("disabled", false);
                            }
                        });
                    });

                    //倒计时函数
                    function countDown() {
                        var time = interval;
                        //启动定时器
                        countdown = setInterval(function() {
                            time -= 1;
                            $("#send-verify").text(time + "秒后重试");
                            if (time <= 0) {
                                clearInterval(countdown);
                                countdown = null;
                                $("#send-verify").text("发送验证码");
                                $("#send-verify").prop("disabled", false);
                            }
                        }, 1000);
                    }

                    //找回密码按钮点击事件
                    $("#find-password-btn").click(function() {
                        var username = $("#username").val();
                        var phone = $("#phone").val();
                        var verify = $("#verify").val();
                        if (!username) {
                            alert("请输入用户名");
                            return;
                        }
                        if (!/^1[3-9]\d{9}$/.test(phone)) {
                            alert("请输入正确的中国境内手机号");
                            return;
                        }
                        if (!verify) {
                            alert("请输入验证码");
                            return;
                        }

                        //请求找回密码接口
                        $.post("/user/findPassword", {username: username, phone: phone, code: verify}, function(result) {
                            if (result.state === 200) {
                                alert(result.data);
                                location.href = "login.html";
                            } else {
                                alert("验证失败：" + result.message);
                            }
                        });
                    });
                });
            </script>
</body>
</html>